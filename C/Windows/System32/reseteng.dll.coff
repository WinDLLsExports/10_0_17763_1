Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\reseteng.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdll.dll
    dbghelp.dll
    KERNEL32.dll
    ReAgent.dll
    bcrypt.dll
    FLTLIB.DLL
    USER32.dll
    SHELL32.dll
    ole32.dll
    OLEAUT32.dll
    SETUPAPI.dll
    imagehlp.dll
    RPCRT4.dll
    ADVAPI32.dll
    SHLWAPI.dll
    DismApi.DLL
    VSSAPI.DLL
    tbs.dll
    VirtDisk.dll
    VERSION.dll
    Cabinet.dll
    WDSCORE.dll

  Section contains the following exports for ResetEng.dll

    00000000 characteristics
    349E073D time date stamp
        0.00 version
           1 ordinal base
          52 number of functions
          52 number of names

    ordinal hint RVA      name

          1    0 00005330 RjvApplyData
          2    1 00009890 RjvApplyDataEntryPoint
          3    2 00003280 RjvBareMetalResetAvailable
          4    3 00004CD0 RjvBasicReset
          5    4 00003AB0 RjvBasicResetChecks
          6    5 000076B0 RjvCheckBattery
          7    6 00007820 RjvCheckBitLocker
          8    7 00007960 RjvCheckDiskSpace
          9    8 00007BF0 RjvCheckOsHealth
         10    9 00006EC0 RjvCheckWinRE
         11    A 00005910 RjvCleanup
         12    B 00009420 RjvCommitReset
         13    C 00009590 RjvCreateSuccessTaskEntryPoint
         14    D 00005CC0 RjvDelayedCleanup
         15    E 000095F0 RjvDelayedCleanupEntryPoint
         16    F 00002F80 RjvFactoryImageAvailable
         17   10 00004F10 RjvFactoryReset
         18   11 00003E70 RjvFactoryResetChecks
         19   12 00009540 RjvFinalize
         20   13 00006E80 RjvGenerateImageBasedBMRConfigData
         21   14 00006EA0 RjvGenerateReconstructionBMRConfigData
         22   15 0000C8E0 RjvGetCloudRecInfo
         23   16 000081C0 RjvGetVolumeInfo
         24   17 00001C80 RjvInitializeEngine
         25   18 0000CB00 RjvInitializeSystemPartitionInfo
         26   19 0000C870 RjvIsCloudRec
         27   1A 00008710 RjvLoadState
         28   1B 00009800 RjvLogFailureEntryPoint
         29   1C 00009600 RjvLogSuccessEntryPoint
         30   1D 00008C70 RjvOfflineCleanup
         31   1E 00022510 RjvPDeleteFilesFromVolumeBeforeWimApply
         32   1F 00023600 RjvPEraseVolume
         33   20 000036A0 RjvPolicyAllowsReset
         34   21 00009BD0 RjvPostApplyDataEntryPoint
         35   22 00009940 RjvPreApplyDataEntryPoint
         36   23 00004640 RjvPrepareForReset
         37   24 00002330 RjvReInitializeEngine
         38   25 0000C930 RjvRePartitionSystemDisk
         39   26 0000CC80 RjvRePartitionSystemDiskEx
         40   27 00005B50 RjvRollBack
         41   28 00008A90 RjvSaveState
         42   29 00002EB0 RjvSendCancelEvent
         43   2A 0000C880 RjvSetCloudRecInfo
         44   2B 000091F0 RjvStageBasicReset
         45   2C 00001A70 RjvStartLogging
         46   2D 00001C20 RjvStopLogging
         47   2E 00009D70 RjvSysResetErrBasicEntryPoint
         48   2F 00009CF0 RjvSysResetErrFactoryEntryPoint
         49   30 0000C810 RjvTestFunction
         50   31 00004BD0 RjvUndoPrepareForReset
         51   32 00002DC0 RjvUninitializeEngine
         52   33 00004310 RjvVerifySystemDiskInfo

  Section contains the following imports:

    msvcrt.dll
             1800DD810 Import Address Table
             18011EB98 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         520 wprintf
                         4EC towupper
                         493 memcpy_s
                         44C free
                         486 malloc
                         369 _vsnwprintf
                         38E _wcslwr
                         4A4 qsort
                          5B __CxxFrameHandler3
                         3C4 _wfopen_s
                         44B fread
                         436 fclose
                         457 fwrite
                         439 fflush
                         360 _vscwprintf
                         394 _wcsnicmp
                         478 iswspace
                         501 wcschr
                         105 _errno
                         518 wcstol
                         2BD _set_errno
                         510 wcsrchr
                         4C5 strcpy_s
                         46F iswalpha
                         2D7 _snwprintf_s
                         456 fwprintf_s
                         505 wcscpy_s
                         500 wcscat_s
                         4DC swprintf_s
                         50E wcsnlen
                         4B9 sprintf_s
                          57 __C_specific_handler
                         390 _wcslwr_s
                         4DE swscanf_s
                         421 atol
                          B4 _atoi64
                         514 wcsstr
                           B ??0exception@@QEAA@AEBQEBDH@Z
                           C ??0exception@@QEAA@AEBV0@@Z
                          11 ??1exception@@UEAA@XZ
                          31 ?what@exception@@UEBAPEBDXZ
                          BF _callnewh
                          4B _CxxThrowException
                          55 _XcptFilter
                          AE _amsg_exit
                         17D _initterm
                          2F ?terminate@@YAXXZ
                          12 ??1type_info@@UEAA@XZ
                         1E6 _lock
                         341 _unlock
                          7B __dllonexit
                         290 _onexit
                         496 memset
                         494 memmove
                         492 memcpy
                         491 memcmp
                         2F2 _strcmpi
                         495 memmove_s
                         51B wcstoul
                         33B _ultow_s
                         36B _vsnwprintf_s
                         50D wcsncpy_s
                         2DB _snwscanf_s
                         3A6 _wcsupr
                         50B wcsncmp
                         405 _wtoi
                         39E _wcstoi64
                         385 _wcsdup
                         4CD strncmp
                         4EA toupper
                         363 _vsnprintf
                         38A _wcsicmp
                         29E _purecall
                         502 wcscmp

    ntdll.dll
             1800DDA68 Import Address Table
             18011EDF0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         2EF RtlCheckPortableOperatingSystem
                         303 RtlCompareMemory
                         14C NtEnumerateBootEntries
                         1CA NtQueryDirectoryObject
                         195 NtOpenDirectoryObject
                         272 NtTranslateFilePath
                         1C4 NtQueryBootOptions
                         1C3 NtQueryBootEntryOrder
                         1F6 NtQueryValueKey
                         145 NtDeviceIoControlFile
                         1EE NtQuerySymbolicLinkObject
                         19C NtOpenKey
                         1AD NtOpenSymbolicLinkObject
                         1BA NtPrivilegeCheck
                         1B0 NtOpenThreadTokenEx
                         243 NtSetInformationThread
                         1A7 NtOpenProcessTokenEx
                          CC NtAdjustPrivilegesToken
                         7A1 ZwOpenSymbolicLinkObject
                         73A ZwDeviceIoControlFile
                         7E2 ZwQuerySymbolicLinkObject
                         6C9 ZwAllocateUuids
                         799 ZwOpenProcess
                         7C6 ZwQueryInformationFile
                         733 ZwDeleteFile
                         446 RtlInitAnsiString
                         7C9 ZwQueryInformationProcess
                          78 LdrGetDllHandle
                         7EC ZwQueryVolumeInformationFile
                          80 LdrGetProcedureAddress
                         790 ZwOpenKey
                         850 ZwSetValueKey
                         33B RtlCreateSecurityDescriptor
                         869 ZwUnloadKey
                         844 ZwSetSecurityObject
                         328 RtlCreateAcl
                         7EA ZwQueryValueKey
                         743 ZwEnumerateKey
                         734 ZwDeleteKey
                         3E1 RtlFreeSid
                         819 ZwSaveKey
                         737 ZwDeleteValueKey
                         4B3 RtlLengthSid
                         2C8 RtlAllocateAndInitializeSid
                         2AB RtlAddAccessAllowedAceEx
                         772 ZwLoadKey
                         70B ZwCreateKey
                         706 ZwCreateFile
                         567 RtlSetDaclSecurityDescriptor
                         575 RtlSetOwnerSecurityDescriptor
                         4B2 RtlLengthSecurityDescriptor
                         7B5 ZwQueryAttributesFile
                         2D6 RtlAppendUnicodeToString
                         7E5 ZwQuerySystemInformation
                         795 ZwOpenMutant
                         7FE ZwReleaseMutant
                         7D3 ZwQueryKey
                         878 ZwWaitForSingleObject
                         6F0 ZwClose
                         78D ZwOpenFile
                         59D RtlStringFromGUID
                         28D NtYieldExecution
                         35F RtlDeleteCriticalSection
                         52A RtlReAllocateHeap
                         525 RtlRaiseStatus
                          23 DbgPrintEx
                         45A RtlInitializeCriticalSection
                         368 RtlDeleteResource
                         53A RtlReleaseResource
                         2A4 RtlAcquireResourceShared
                         2A3 RtlAcquireResourceExclusive
                         464 RtlInitializeResource
                         443 RtlImpersonateSelf
                         234 NtSetEaFile
                         199 NtOpenFile
                          FB NtClose
                         111 NtCreateFile
                         23C NtSetInformationFile
                         1D5 NtQueryInformationProcess
                         1D2 NtQueryInformationFile
                         1F8 NtQueryVolumeInformationFile
                         250 NtSetSecurityObject
                         3BD RtlFindAceByType
                         562 RtlSetControlSecurityDescriptor
                         40B RtlGetLastNtStatus
                         3E3 RtlFreeUnicodeString
                         2CB RtlAllocateHeap
                         1F1 NtQuerySystemInformation
                         2C6 RtlAdjustPrivilege
                         1C8 NtQueryDirectoryFile
                         3E5 RtlGUIDFromString
                         6A1 WinSqmEndSession
                         6AF WinSqmSetString
                         6AB WinSqmSetDWORD64
                         6AA WinSqmSetDWORD
                         6B0 WinSqmStartSession
                         385 RtlDosPathNameToNtPathName_U
                         435 RtlGetVersion
                         451 RtlInitUnicodeString
                         3DD RtlFreeHeap
                         4DE RtlNtStatusToDosErrorNoTeb
                         4DD RtlNtStatusToDosError
                         2EA RtlCaptureContext
                         4CA RtlLookupFunctionEntry
                         5F2 RtlVirtualUnwind
                         2D5 RtlAppendUnicodeStringToString

    dbghelp.dll
             1800DD7E8 Import Address Table
             18011EB70 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          16 ImageNtHeader

    KERNEL32.dll
             1800DD178 Import Address Table
             18011E500 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         5E6 WaitForSingleObject
                         324 GetVersionExW
                         27A GetModuleFileNameW
                         646 lstrcmpiW
                         2EA GetSystemInfo
                         121 DeviceIoControl
                         32B GetVolumePathNameW
                         329 GetVolumeNameForVolumeMountPointW
                         252 GetFileSize
                         25B GetFirmwareEnvironmentVariableW
                         32D GetVolumePathNamesForVolumeNameW
                         230 GetDiskFreeSpaceW
                         34E HeapAlloc
                         2BB GetProcessHeap
                         186 FindFirstFileW
                         192 FindNextFileW
                         17B FindClose
                         352 HeapFree
                          BA CreateDirectoryW
                         52B SetFileAttributesW
                          DD CreatePipe
                          E5 CreateProcessW
                          C8 CreateFileMappingW
                         3E1 MapViewOfFile
                         5BF UnmapViewOfFile
                         217 GetCurrentDirectoryW
                         524 SetEvent
                         3C6 LoadLibraryExW
                         2B5 GetProcAddress
                         1B1 FreeLibrary
                         59A TerminateProcess
                         582 SetVolumeMountPointW
                         3CD LocalAlloc
                         3D2 LocalFree
                         534 SetFileTime
                          A7 CopyFile2
                         254 GetFileTime
                         539 SetFirmwareEnvironmentVariableW
                         21D GetCurrentProcess
                         4BD RemoveDirectoryW
                         5BC UnhandledExceptionFilter
                         57B SetUnhandledExceptionFilter
                         450 QueryPerformanceCounter
                         21E GetCurrentProcessId
                         222 GetCurrentThreadId
                         30E GetTickCount
                         58D SleepConditionVariableSRW
                         5EE WakeAllConditionVariable
                         351 HeapDestroy
                          F2 CreateThread
                          BF CreateEventW
                           8 AddDllDirectory
                         243 GetExitCodeProcess
                         3C7 LoadLibraryW
                         5E4 WaitForMultipleObjects
                          9B CompareStringW
                         257 GetFinalPathNameByHandleW
                           0 AcquireSRWLockExclusive
                         4B6 ReleaseSRWLockExclusive
                         279 GetModuleFileNameA
                         323 GetVersionExA
                         181 FindFirstFileExW
                         466 RaiseException
                         357 HeapSize
                         3CF LocalFileTimeToFileTime
                         2E7 GetSystemDirectoryW
                         12A DosDateTimeToFileTime
                          EB CreateSemaphoreExW
                         2FD GetTempPathW
                         60D WideCharToMultiByte
                         4CA ResetEvent
                         5E5 WaitForMultipleObjectsEx
                         5AF TlsSetValue
                         5AE TlsGetValue
                         5AD TlsFree
                         5AC TlsAlloc
                         32F GetWindowsDirectoryW
                         3F2 MultiByteToWideChar
                         53F SetLastError
                         240 GetEnvironmentVariableW
                         19E FindVolumeClose
                         197 FindNextVolumeW
                         236 GetDriveTypeW
                         18C FindFirstVolumeW
                         523 SetErrorMode
                         58B Sleep
                         2F0 GetSystemTimeAsFileTime
                         22F GetDiskFreeSpaceExW
                         2EB GetSystemPowerStatus
                         168 ExpandEnvironmentStringsW
                         429 PowerSetRequest
                         428 PowerCreateRequest
                         596 SystemTimeToFileTime
                         268 GetLocalTime
                         30F GetTickCount64
                         24C GetFileAttributesW
                         253 GetFileSizeEx
                         477 ReadFile
                          CB CreateFileW
                         530 SetFilePointer
                         621 WriteFile
                         116 DeleteFileW
                         517 SetCurrentDirectoryW
                         2F4 GetSystemWindowsDirectoryW
                          AD CopyFileW
                         267 GetLastError
                          86 CloseHandle
                         307 GetThreadPreferredUILanguages
                          CF CreateHardLinkW
                         1A5 FlushFileBuffers
                         327 GetVolumeInformationW
                         27E GetModuleHandleW
                         3EB MoveFileExW
                         135 EnterCriticalSection
                         3C0 LeaveCriticalSection
                         367 InitializeCriticalSection
                         221 GetCurrentThread
                         29F GetOverlappedResult
                         111 DeleteCriticalSection
                         264 GetHandleInformation
                         531 SetFilePointerEx
                         51E SetEndOfFile
                         24E GetFileInformationByHandle
                         566 SetThreadIdealProcessor
                         355 HeapReAlloc
                         404 OpenEventW
                         260 GetFullPathNameW
                         368 InitializeCriticalSectionAndSpinCount
                         3DD LockFileEx
                         5BE UnlockFileEx
                         343 GlobalMemoryStatusEx
                         326 GetVolumeInformationByHandleW
                         27D GetModuleHandleExW
                         410 OpenProcess
                          AA CopyFileExW
                         12F DuplicateHandle
                         2B0 GetPrivateProfileSectionW
                         4B8 ReleaseSemaphore
                          EC CreateSemaphoreW

    ReAgent.dll
             1800DD660 Import Address Table
             18011E9E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           E WinReDeleteLogFiles
                           F WinReGetConfig
                          1B WinReIsWimBootEnabled
                          25 WinReRestoreLogFiles
                          2B WinReSetRecoveryAction
                          19 WinReInstallOnTargetOS

    bcrypt.dll
             1800DD7A8 Import Address Table
             18011EB30 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          21 BCryptGetProperty
                           D BCryptDestroyHash
                          1B BCryptFinishHash
                          23 BCryptHashData
                           6 BCryptCreateHash
                          27 BCryptOpenAlgorithmProvider
                           2 BCryptCloseAlgorithmProvider

    FLTLIB.DLL
             1800DD160 Import Address Table
             18011E4E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 FilterLoad
                           0 FilterAttach

    USER32.dll
             1800DD6F8 Import Address Table
             18011EA80 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          3E CharUpperW
                         3B9 UnregisterClassA
                         260 LoadStringW

    SHELL32.dll
             1800DD6D8 Import Address Table
             18011EA60 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         1B5 ShellExecuteExW

    ole32.dll
             1800DDDC0 Import Address Table
             18011F148 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          61 CoInitializeEx
                          2A CoCreateGuid
                          62 CoInitializeSecurity
                          90 CoUninitialize
                          8C CoTaskMemFree
                          87 CoSetProxyBlanket
                          2B CoCreateInstance

    OLEAUT32.dll
             1800DD5D8 Import Address Table
             18011E960 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   149
                             Ordinal     2
                             Ordinal    10
                             Ordinal     7
                             Ordinal    24
                             Ordinal     6
                             Ordinal     4
                             Ordinal    23
                             Ordinal     8
                             Ordinal     9

    SETUPAPI.dll
             1800DD698 Import Address Table
             18011EA20 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         154 SetupDiGetClassDevsW
                         141 SetupDiEnumDeviceInterfaces
                         16C SetupDiGetDeviceInterfaceDetailW
                         16E SetupDiGetDeviceInterfacePropertyW
                         13D SetupDiDestroyDeviceInfoList
                         170 SetupDiGetDevicePropertyW
                         193 SetupDiOpenDeviceInfoW

    imagehlp.dll
             1800DD7F8 Import Address Table
             18011EB80 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1F ImageUnload
                          1A ImageLoad

    RPCRT4.dll
             1800DD630 Import Address Table
             18011E9B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         212 RpcStringFreeW
                         21A UuidCompare
                         21B UuidCreate
                          44 I_RpcMapWin32Status
                         224 UuidToStringW

    ADVAPI32.dll
             1800DCF50 Import Address Table
             18011E2D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         264 RegCreateKeyExW
                         121 EventRegister
                         122 EventSetInformation
                         129 EventWriteTransfer
                         285 RegLoadKeyW
                         281 RegGetValueW
                         2A6 RegSetKeyValueW
                         28C RegOpenKeyExW
                         25B RegCloseKey
                         2AC RegUnLoadKeyW
                         2A9 RegSetValueExW
                         2FD StartTraceW
                         108 EnableTraceEx
                          67 CloseTrace
                         2FF StopTraceW
                         299 RegQueryValueExW
                         293 RegQueryInfoKeyW
                         27A RegEnumKeyExW
                          C2 CryptAcquireContextW
                          D2 CryptGenRandom
                         145 GetFileSecurityW
                         2DC SetFileSecurityW
                         215 OpenProcessToken
                         1AF LookupPrivilegeValueW
                          1F AdjustTokenPrivileges
                         195 InitiateSystemShutdownExW
                         2C1 RevertToSelf
                          63 CloseEncryptedFileRaw
                         358 WriteEncryptedFileRaw
                         212 OpenEncryptedFileRawW
                         27E RegFlushKey
                         273 RegDeleteValueW
                         138 GetAclInformation
                         15F GetSecurityDescriptorLength
                         15C GetSecurityDescriptorControl
                         124 EventWrite
                         2ED SetSecurityInfo
                         163 GetSecurityInfo
                         261 RegCopyTreeW
                         271 RegDeleteTreeW
                         120 EventProviderEnabled
                         2E3 SetNamedSecurityInfoW
                         162 GetSecurityDescriptorSacl
                         15D GetSecurityDescriptorDacl
                         15E GetSecurityDescriptorGroup
                         160 GetSecurityDescriptorOwner
                          81 ConvertStringSecurityDescriptorToSecurityDescriptorW
                         328 TraceMessage
                         123 EventUnregister

    SHLWAPI.dll
             1800DD6E8 Import Address Table
             18011EA70 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         123 StrCmpIW

    DismApi.DLL
             1800DD100 Import Address Table
             18011E488 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          31 _DismGetCurrentEdition
                          1A DismOpenSession
                          23 _DismAddDriverEx
                          55 _DismSetProductKey
                          19 DismMountImage
                          21 DismUnmountImage
                          3C _DismGetOsInfo
                          18 DismInitialize
                          20 DismShutdown
                           6 DismCloseSession
                           8 DismDelete

    VSSAPI.DLL
             1800DD738 Import Address Table
             18011EAC0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          53 VssFreeSnapshotPropertiesInternal
                          43 CreateVssBackupComponentsInternal

    tbs.dll
             1800DDE00 Import Address Table
             18011F188 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 Tbsi_GetDeviceInfo
                           C Tbsi_Physical_Presence_Command
                           3 Tbsi_Context_Create
                          10 Tbsip_Context_Close

    VirtDisk.dll
             1800DD750 Import Address Table
             18011EAD8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           E GetStorageDependencyInformation

    VERSION.dll
             1800DD718 Import Address Table
             18011EAA0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 VerQueryValueW
                           3 GetFileVersionInfoExW
                           6 GetFileVersionInfoSizeExW

    Cabinet.dll
             1800DD0E0 Import Address Table
             18011E468 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    20
                             Ordinal    23
                             Ordinal    22

    WDSCORE.dll
             1800DD760 Import Address Table
             18011EAE8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          96 WdsSetupLogMessageA
                          97 WdsSetupLogMessageW
                          45 ConstructPartialMsgVW
                          46 CurrentIP
                          6A WdsGenericSetupLogInit
                          94 WdsSetupLogDestroy
                          44 ConstructPartialMsgVA
                          73 WdsGetSetupLog

  Summary

        6000 .data
        6000 .pdata
       47000 .rdata
        1000 .reloc
        1000 .rsrc
       DA000 .text
