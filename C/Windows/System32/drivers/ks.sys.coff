Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\drivers\ks.sys

File Type: DLL

  Image has the following dependencies:

    ntoskrnl.exe
    HAL.dll

  Section contains the following imports:

    ntoskrnl.exe
             1C0023010 Import Address Table
             1C00236E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         154 ExpInterlockedPushEntrySList
                          D2 ExInitializePagedLookasideList
                         423 KeInitializeSpinLock
                          EC ExQueryDepthSList
                          AD ExDeletePagedLookasideList
                         49C KeSetEvent
                          D1 ExInitializeNPagedLookasideList
                          9C ExAllocatePoolWithTag
                          C3 ExFreePoolWithTag
                         41B KeInitializeEvent
                         3AA IofCompleteRequest
                         4C5 KeWaitForSingleObject
                         ABB __C_specific_handler
                         72D RtlAppendUnicodeStringToString
                         72E RtlAppendUnicodeToString
                         A0E ZwEnumerateValueKey
                         2EB IoGetRelatedDeviceObject
                         2DD IoGetFileObjectGenericMapping
                         5F8 ObfDereferenceObject
                         7C3 RtlFreeUnicodeString
                         900 SeAssignSecurity
                         7FC RtlInitUnicodeString
                         9F1 ZwCreateKey
                         30E IoOpenDeviceRegistryKey
                         760 RtlCopyUnicodeString
                         2CF IoGetDeviceAttachmentBaseRef
                         277 IoBuildDeviceIoControlRequest
                         8B2 RtlStringFromGUID
                         94B SeReleaseSubjectContext
                         5FA ObfReferenceObject
                         3A9 IofCallDriver
                         A6F ZwQueryValueKey
                         811 RtlIntegerToUnicodeString
                          CA ExGetPreviousMode
                         279 IoBuildSynchronousFsdRequest
                         9E3 ZwClose
                         AA6 ZwSetValueKey
                         659 ProbeForRead
                         A31 ZwOpenKey
                         74C RtlCompareMemory
                         910 SeCaptureSubjectContext
                         4AC KeSetTimer
                         32A IoRegisterDeviceInterface
                         26E IoAllocateWorkItem
                         AE4 _vsnwprintf
                         A63 ZwQueryKey
                         7C4 RtlGUIDFromString
                         417 KeInitializeDpc
                         3D9 KeBugCheckEx
                         352 IoSetDeviceInterfaceState
                         2AD IoDetachDevice
                          84 ExAcquireFastMutexUnsafe
                          9B ExAllocatePoolWithQuotaTag
                         108 ExReleaseFastMutex
                          AE ExDeleteResourceLite
                         AE7 _wcsicmp
                         3F2 KeEnterCriticalRegion
                          8A ExAcquireResourceExclusiveLite
                          F1 ExQueueWorkItem
                         30D IoOpenDeviceInterfaceRegistryKey
                         146 ExWaitForRundownProtectionRelease
                         A2A ZwNotifyChangeKey
                         2AA IoDeleteDevice
                          D5 ExInitializeRundownProtection
                         425 KeInitializeTimer
                         65A ProbeForWrite
                         273 IoAttachDeviceToDeviceStack
                          8C ExAcquireRundownProtection
                         114 ExReleaseResourceLite
                         A02 ZwDeleteKey
                         A0C ZwEnumerateKey
                         3DA KeCancelTimer
                         2D6 IoGetDeviceProperty
                          83 ExAcquireFastMutex
                         2C2 IoFreeWorkItem
                         293 IoCreateDevice
                         AEA _wcsnicmp
                         31C IoQueueWorkItem
                         956 SeSinglePrivilegeCheck
                         402 KeFlushQueuedDpcs
                         115 ExReleaseRundownProtection
                          D4 ExInitializeResourceLite
                         2FD IoInvalidateDeviceRelations
                         109 ExReleaseFastMutexUnsafe
                         43D KeLeaveCriticalRegion
                         3C9 KeAcquireSpinLockRaiseToDpc
                         427 KeInitializeTimerEx
                         4AE KeSetTimerEx
                         47D KeReleaseSpinLock
                         3C7 KeAcquireSpinLockAtDpcLevel
                         47F KeReleaseSpinLockFromDpcLevel
                         461 KeQueryTimeIncrement
                         4A1 KeSetImportanceDpc
                         42E KeInsertQueueDpc
                         11F ExSemaphoreObjectType
                         4B7 KeSynchronizeExecution
                         488 KeRemoveQueueDpc
                         47A KeReleaseMutex
                         441 KeLowerIrql
                         5E8 ObReferenceObjectByHandle
                         47C KeReleaseSemaphore
                         4C7 KfRaiseIrql
                          AC ExDeleteNPagedLookasideList
                         74F RtlCompareUnicodeString
                         54F MmUnlockPages
                         8F0 RtlWriteRegistryValue
                         8FF SeAppendPrivileges
                         53B MmProbeAndLockPages
                         929 SeFreePrivileges
                         84F RtlMapGenericMask
                         8F7 SeAccessCheck
                         607 PoCallDriver
                         2BE IoFreeIrp
                         26B IoAllocateMdl
                          8B ExAcquireResourceSharedLite
                         943 SeQuerySecurityDescriptorInfo
                          7B EtwWriteTransfer
                         3DF KeClearEvent
                         2BF IoFreeMdl
                         296 IoCreateFile
                         935 SeOpenObjectAuditAlarm
                         269 IoAllocateIrp
                         961 SeUnlockSubjectContext
                         260 IoAcquireCancelSpinLock
                         953 SeSetSecurityDescriptorInfo
                         528 MmMapLockedPagesSpecifyCache
                         932 SeLockSubjectContext
                          F6 ExRaiseStatus
                         334 IoReleaseCancelSpinLock
                         653 PoStartNextPowerIrp
                         521 MmLockPagableDataSection
                         4E9 MmAddVerifierThunks
                         2D5 IoGetDeviceObjectPointer
                         11B ExReleaseSpinLockShared
                          94 ExAcquireSpinLockShared
                         51F MmIsVerifierEnabled
                         4D6 LdrFindResource_U
                         4D2 LdrAccessResource
                         2DC IoGetDriverObjectExtension
                         41F KeInitializeMutex
                         2B9 IoFileObjectType
                         267 IoAllocateDriverObjectExtension
                         513 MmGetSystemRoutineAddress
                          70 EtwRegister
                         39D IoWMIRegistrationControl
                         2D3 IoGetDeviceInterfaces
                         261 IoAcquireRemoveLockEx
                         336 IoReleaseRemoveLockEx
                         519 MmIsDriverVerifying
                         335 IoReleaseRemoveLockAndWaitEx
                         27C IoCancelIrp
                         656 PoUnregisterSystemState
                         309 IoIsWdmVersionAvailable
                         643 PoRequestPowerIrp
                         2FA IoInitializeRemoveLockEx
                         641 PoRegisterSystemState
                         64A PoSetPowerState
                         4E6 Mm64BitPhysicalAddress
                         2D7 IoGetDevicePropertyData
                         A03 ZwDeleteValueKey
                         351 IoSetDeviceInterfacePropertyData
                         927 SeExports
                         2E2 IoGetInitiatorProcess
                         697 PsGetProcessId
                         6A2 PsGetProcessSessionId
                         469 KeReadStateMutex
                         6B4 PsGetThreadProcess
                         805 RtlInitializeSid
                         8B5 RtlSubAuthoritySid
                          DD ExInterlockedInsertTailList
                         741 RtlCheckTokenMembership
                         840 RtlLengthRequiredSid
                         2D1 IoGetDeviceInterfaceAlias
                         48D KeResetEvent
                          DC ExInterlockedInsertHeadList
                         401 KeFlushIoBuffers
                          E0 ExInterlockedRemoveHeadList
                         4F4 MmAllocatePagesForMdl
                         50B MmFreePagesFromMdl
                         552 MmUnmapLockedPages
                         66B PsDereferencePrimaryToken
                         877 RtlQueryPackageClaims
                         6E2 PsReferencePrimaryToken
                         AB6 ZwUpdateWnfStateData
                         640 PoRegisterPowerSettingCallback
                         655 PoUnregisterPowerSettingCallback
                         129 ExSubscribeWnfStateChange
                         142 ExUnsubscribeWnfStateChange
                         460 KeQuerySystemTimePrecise
                         A2E ZwOpenEvent
                         467 KeReadStateEvent
                         8E7 RtlValidSid
                         755 RtlConvertSidToUnicodeString
                         71A RtlAddAccessAllowedAceEx
                         93E SeQueryInformationToken
                         2CE IoGetCurrentProcess
                         5E3 ObOpenObjectByPointer
                         842 RtlLengthSid
                         6D6 PsLookupProcessByProcessId
                         75D RtlCopySid
                         A69 ZwQuerySecurityObject
                         794 RtlEqualSid
                         A9F ZwSetSecurityObject
                         896 RtlSelfRelativeToAbsoluteSD
                          BB ExEventObjectType
                         153 ExpInterlockedPopEntrySList

    HAL.dll
             1C0023000 Import Address Table
             1C00236D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          53 KeQueryPerformanceCounter

  Section contains the following exports for ks.sys

    00000000 characteristics
    6BD926B2 time date stamp
        0.00 version
           1 ordinal base
         237 number of functions
         237 number of names

    ordinal hint RVA      name

          1    0 00041600 ??0CBaseUnknown@@QEAA@AEBU_GUID@@PEAUIUnknown@@@Z
          2    1 0002CAA0 ??0CBaseUnknown@@QEAA@PEAUIUnknown@@@Z
          3    2 00041640 ??1CBaseUnknown@@UEAA@XZ
          4    3 00006400 ??_FCBaseUnknown@@QEAAXXZ
          5    4 00041660 ?IndirectedAddRef@CBaseUnknown@@UEAAKXZ
          6    5 00041680 ?IndirectedQueryInterface@CBaseUnknown@@UEAAJAEBU_GUID@@PEAPEAX@Z
          7    6 000416A0 ?IndirectedRelease@CBaseUnknown@@UEAAKXZ
          8    7 0002B110 ?NonDelegatedAddRef@CBaseUnknown@@UEAAKXZ
          9    8 000416C0 ?NonDelegatedQueryInterface@CBaseUnknown@@UEAAJAEBU_GUID@@PEAPEAX@Z
         10    9 0002B130 ?NonDelegatedRelease@CBaseUnknown@@UEAAKXZ
         11    A 0006E080 DllInitialize
         12    B 00041880 KoCreateInstance
         13    C 00041B30 KoDeviceInitialize
         14    D 00041E10 KoDriverInitialize
         15    E 00041EE0 KoRelease
         16    F 0004FD90 KsAcquireCachedMdl
         17   10 00048930 KsAcquireControl
         18   11 00044340 KsAcquireDevice
         19   12 0003E740 KsAcquireDeviceSecurityLock
         20   13 0003A9E0 KsAcquireResetValue
         21   14 0002B9E0 KsAddDevice
         22   15 000489A0 KsAddEvent
         23   16 000053A0 KsAddIrpToCancelableQueue
         24   17 00032530 KsAddItemToObjectBag
         25   18 0003E7A0 KsAddObjectCreateItemToDeviceHeader
         26   19 0003E7C0 KsAddObjectCreateItemToObjectHeader
         27   1A 0003D610 KsAllocateDefaultClock
         28   1B 0003D640 KsAllocateDefaultClockEx
         29   1C 0002F6F0 KsAllocateDeviceHeader
         30   1D 0003E7F0 KsAllocateExtraData
         31   1E 000443A0 KsAllocateObjectBag
         32   1F 0003E940 KsAllocateObjectCreateItem
         33   20 00027FB0 KsAllocateObjectHeader
         34   21 0003AA50 KsCacheMedium
         35   22 000054D0 KsCancelIo
         36   23 00005590 KsCancelRoutine
         37   24 00006D80 KsCompletePendingRequest
         38   25 00048A10 KsCopyObjectBagItems
         39   26 0003A500 KsCreateAllocator
         40   27 00030850 KsCreateBusEnumObject
         41   28 0003D820 KsCreateClock
         42   29 0003A540 KsCreateDefaultAllocator
         43   2A 0003A570 KsCreateDefaultAllocatorEx
         44   2B 0003D860 KsCreateDefaultClock
         45   2C 0003AEC0 KsCreateDefaultSecurity
         46   2D 0002C800 KsCreateDevice
         47   2E 00032C20 KsCreateFilterFactory
         48   2F 0003DB90 KsCreatePin
         49   30 000410A0 KsCreateTopologyNode
         50   31 00005EE0 KsDecrementCountedWorker
         51   32 00048B70 KsDefaultAddEventHandler
         52   33 000289D0 KsDefaultDeviceIoCompletion
         53   34 00028410 KsDefaultDispatchPnp
         54   35 00005630 KsDefaultDispatchPower
         55   36 0003EA90 KsDefaultForwardIrp
         56   37 00028820 KsDereferenceBusObject
         57   38 00028820 KsDereferenceSoftwareBusObject
         58   39 00006E70 KsDeviceGetBusData
         59   3A 00044450 KsDeviceRegisterAdapterObject
         60   3B 000444F0 KsDeviceRegisterThermalDispatch
         61   3C 00006F20 KsDeviceSetBusData
         62   3D 0003E1C0 KsDisableEvent
         63   3E 00004C80 KsDiscardEvent
         64   3F 0003EB60 KsDispatchFastIoDeviceControlFailure
         65   40 0003EB60 KsDispatchFastReadFailure
         66   41 0003EB70 KsDispatchInvalidDeviceRequest
         67   42 0002BA60 KsDispatchIrp
         68   43 0003EBA0 KsDispatchQuerySecurity
         69   44 0003ECA0 KsDispatchSetSecurity
         70   45 0003EDC0 KsDispatchSpecificMethod
         71   46 0003EE80 KsDispatchSpecificProperty
         72   47 00028940 KsEnableEvent
         73   48 0003E250 KsEnableEventWithAllocator
         74   49 00040690 KsFastMethodHandler
         75   4A 000408E0 KsFastPropertyHandler
         76   4B 00047A40 KsFilterAcquireProcessingMutex
         77   4C 00047AB0 KsFilterAddTopologyConnections
         78   4D 00008E30 KsFilterAttemptProcessing
         79   4E 00047AD0 KsFilterCreateNode
         80   4F 00047AF0 KsFilterCreatePinFactory
         81   50 00045730 KsFilterFactoryAddCreateItem
         82   51 000457D0 KsFilterFactoryGetSymbolicLink
         83   52 00045830 KsFilterFactorySetDeviceClassesState
         84   53 000458A0 KsFilterFactoryUpdateCacheData
         85   54 00008ED0 KsFilterGetAndGate
         86   55 00047B10 KsFilterGetChildPinCount
         87   56 00047B80 KsFilterGetFirstChildPin
         88   57 00047C00 KsFilterRegisterPowerCallbacks
         89   58 00047C70 KsFilterReleaseProcessingMutex
         90   59 0003AF50 KsForwardAndCatchIrp
         91   5A 0003B0C0 KsForwardIrp
         92   5B 0003D940 KsFreeDefaultClock
         93   5C 0003EED0 KsFreeDeviceHeader
         94   5D 000288F0 KsFreeEventList
         95   5E 00044520 KsFreeObjectBag
         96   5F 0003EF40 KsFreeObjectCreateItem
         97   60 0003EF90 KsFreeObjectCreateItemsByContext
         98   61 00001160 KsFreeObjectHeader
         99   62 00004DA0 KsGenerateDataEvent
        100   63 00004E80 KsGenerateEvent
        101   64 00005140 KsGenerateEventList
        102   65 00009180 KsGenerateEvents
        103   66 00044590 KsGenerateThermalEvent
        104   67 0003BC60 KsGetBusEnumIdentifier
        105   68 0003BD70 KsGetBusEnumParentFDOFromChildPDO
        106   69 0002B170 KsGetBusEnumPnpDeviceObject
        107   6A 00004540 KsGetDefaultClockState
        108   6B 00004550 KsGetDefaultClockTime
        109   6C 0002B1A0 KsGetDevice
        110   6D 00001080 KsGetDeviceForDeviceObject
        111   6E 00001240 KsGetFilterFromIrp
        112   6F 00048BF0 KsGetFirstChild
        113   70 000060F0 KsGetImageNameAndResourceId
        114   71 00048C50 KsGetNextSibling
        115   72 00008FA0 KsGetNodeIdFromIrp
        116   73 000092C0 KsGetObjectFromFileObject
        117   74 00009320 KsGetObjectTypeFromFileObject
        118   75 00009380 KsGetObjectTypeFromIrp
        119   76 00048CB0 KsGetOuterUnknown
        120   77 00048D30 KsGetParent
        121   78 0000A610 KsGetPinFromIrp
        122   79 00027B60 KsHandleSizedListQuery
        123   7A 00005F00 KsIncrementCountedWorker
        124   7B 0002C940 KsInitializeDevice
        125   7C 000458C0 KsInitializeDeviceProfile
        126   7D 0002B1F0 KsInitializeDriver
        127   7E 0003BDA0 KsInstallBusEnumInterface
        128   7F 0002AD90 KsIsBusEnumChildDevice
        129   80 00048D80 KsIsCurrentProcessFrameServer
        130   81 00041140 KsLoadResource
        131   82 00041280 KsMapModuleName
        132   83 00031C00 KsMergeAutomationTables
        133   84 00040870 KsMethodHandler
        134   85 000408A0 KsMethodHandlerWithAllocator
        135   86 00005780 KsMoveIrpsOnCancelableQueue
        136   87 0003EFE0 KsNullDriverUnload
        137   88 000458F0 KsPersistDeviceProfile
        138   89 0004FDE0 KsPinAcquireProcessingMutex
        139   8A 0004FE50 KsPinAttachAndGate
        140   8B 0004FEC0 KsPinAttachOrGate
        141   8C 0000A690 KsPinAttemptProcessing
        142   8D 00028990 KsPinDataIntersection
        143   8E 0000A730 KsPinGetAndGate
        144   8F 0000F000 KsPinGetAvailableByteCount
        145   90 0004FF30 KsPinGetConnectedFilterInterface
        146   91 00050030 KsPinGetConnectedPinDeviceObject
        147   92 00050080 KsPinGetConnectedPinFileObject
        148   93 000500D0 KsPinGetConnectedPinInterface
        149   94 0000A790 KsPinGetCopyRelationships
        150   95 0000F0A0 KsPinGetFirstCloneStreamPointer
        151   96 0000F120 KsPinGetLeadingEdgeStreamPointer
        152   97 00048EF0 KsPinGetNextSiblingPin
        153   98 00048F40 KsPinGetParentFilter
        154   99 000501A0 KsPinGetReferenceClockInterface
        155   9A 0000F1B0 KsPinGetTrailingEdgeStreamPointer
        156   9B 00028620 KsPinPropertyHandler
        157   9C 00050290 KsPinRegisterFrameReturnCallback
        158   9D 00050300 KsPinRegisterHandshakeCallback
        159   9E 00050360 KsPinRegisterIrpCompletionCallback
        160   9F 000503D0 KsPinRegisterPowerCallbacks
        161   A0 00050440 KsPinReleaseProcessingMutex
        162   A1 0000A820 KsPinSetPinClockTime
        163   A2 0000A880 KsPinSubmitFrame
        164   A3 0000A910 KsPinSubmitFrameMdl
        165   A4 0003EFF0 KsProbeStreamIrp
        166   A5 0000A9F0 KsProcessPinUpdate
        167   A6 00027F80 KsPropertyHandler
        168   A7 00040B00 KsPropertyHandlerWithAllocator
        169   A8 00045960 KsPublishDeviceProfile
        170   A9 00028A30 KsQueryDevicePnpObject
        171   AA 0003F6E0 KsQueryInformationFile
        172   AB 0003F8C0 KsQueryObjectAccessMask
        173   AC 0003F8D0 KsQueryObjectCreateItem
        174   AD 00005F30 KsQueueWorkItem
        175   AE 0003F8E0 KsReadFile
        176   AF 0003FB10 KsRecalculateStackDepth
        177   B0 00028740 KsReferenceBusObject
        178   B1 00028740 KsReferenceSoftwareBusObject
        179   B2 00048F90 KsRegisterAggregatedClientUnknown
        180   B3 00041060 KsRegisterCountedWorker
        181   B4 00049010 KsRegisterFilterWithNoKSPins
        182   B5 0002F390 KsRegisterWorker
        183   B6 00050490 KsReleaseCachedMdl
        184   B7 000492C0 KsReleaseControl
        185   B8 000445F0 KsReleaseDevice
        186   B9 0003FBF0 KsReleaseDeviceSecurityLock
        187   BA 00005940 KsReleaseIrpOnCancelableQueue
        188   BB 0003BE70 KsRemoveBusEnumInterface
        189   BC 00001950 KsRemoveIrpFromCancelableQueue
        190   BD 00032400 KsRemoveItemFromObjectBag
        191   BE 000059F0 KsRemoveSpecificIrpFromCancelableQueue
        192   BF 000274F0 KsServiceBusEnumCreateRequest
        193   C0 0002A7A0 KsServiceBusEnumPnpRequest
        194   C1 000045F0 KsSetDefaultClockState
        195   C2 00004760 KsSetDefaultClockTime
        196   C3 0002F560 KsSetDevicePnpAndBaseObject
        197   C4 0003FC20 KsSetInformationFile
        198   C5 0002B2E0 KsSetMajorFunctionHandler
        199   C6 00005A60 KsSetPowerDispatch
        200   C7 0003FDE0 KsSetTargetDeviceObject
        201   C8 0003FEC0 KsSetTargetState
        202   C9 0003FED0 KsStreamIo
        203   CA 0000F240 KsStreamPointerAdvance
        204   CB 0000F300 KsStreamPointerAdvanceOffsets
        205   CC 0000F470 KsStreamPointerAdvanceOffsetsAndUnlock
        206   CD 0000F5B0 KsStreamPointerCancelTimeout
        207   CE 0000F610 KsStreamPointerClone
        208   CF 0000F6C0 KsStreamPointerDelete
        209   D0 0000F720 KsStreamPointerGetIrp
        210   D1 0000F7D0 KsStreamPointerGetMdl
        211   D2 0000F830 KsStreamPointerGetNextClone
        212   D3 0000F8A0 KsStreamPointerLock
        213   D4 0000F920 KsStreamPointerScheduleTimeout
        214   D5 0000F9A0 KsStreamPointerSetStatusCode
        215   D6 0000FA10 KsStreamPointerUnlock
        216   D7 00027010 KsSynchronousIoControlDevice
        217   D8 00044650 KsTerminateDevice
        218   D9 00027A30 KsTopologyPropertyHandler
        219   DA 000011D0 KsUnregisterWorker
        220   DB 0003B170 KsUnserializeObjectPropertiesFromRegistry
        221   DC 0003B380 KsUpdateCameraStreamingConsent
        222   DD 0003A8A0 KsValidateAllocatorCreateRequest
        223   DE 0003A8F0 KsValidateAllocatorFramingEx
        224   DF 0003D9B0 KsValidateClockCreateRequest
        225   E0 0003DBE0 KsValidateConnectRequest
        226   E1 000410D0 KsValidateTopologyNodeCreateRequest
        227   E2 00040130 KsWriteFile
        228   E3 00004800 KsiDefaultClockAddMarkEvent
        229   E4 0003D9F0 KsiPropertyDefaultClockGetCorrelatedPhysicalTime
        230   E5 0003DA20 KsiPropertyDefaultClockGetCorrelatedTime
        231   E6 0003DA50 KsiPropertyDefaultClockGetFunctionTable
        232   E7 0003DA90 KsiPropertyDefaultClockGetPhysicalTime
        233   E8 0003DAC0 KsiPropertyDefaultClockGetResolution
        234   E9 0003DAF0 KsiPropertyDefaultClockGetState
        235   EA 0003DB20 KsiPropertyDefaultClockGetTime
        236   EB 00040680 KsiQueryObjectCreateItemsPresent
        237   EC 0004A4D0 _KsEdit

  Summary

        1000 .data
        3000 .edata
        1000 .guids
        3000 .idata
        4000 .pdata
        B000 .rdata
        4000 .reloc
        2000 .rsrc
       12000 .text
        1000 GFIDS
        1000 INIT
       33000 PAGE
        2000 PAGECONS
        F000 PAGEKsVf
