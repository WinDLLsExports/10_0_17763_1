Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-directory-services-sam_31bf3856ad364e35_10.0.17763.1_none_a2b44342f91dfa60\offlinesam.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdll.dll
    RPCRT4.dll
    bcrypt.dll
    offlinelsa.dll
    CRYPTBASE.dll
    api-ms-win-core-heap-obsolete-l1-1-0.dll
    api-ms-win-eventing-classicprovider-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-1.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-kernel32-legacy-l1-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-security-lsalookup-l2-1-0.dll
    api-ms-win-core-libraryloader-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-memory-l1-1-0.dll
    api-ms-win-security-cryptoapi-l1-1-0.dll

  Section contains the following exports for offlinesam.dll

    00000000 characteristics
    FEBBFB9F time date stamp
        0.00 version
           1 ordinal base
          25 number of functions
          25 number of names

    ordinal hint RVA      name

          1    0 00010150 SamOfflineAddMemberToAlias
          2    1 00010CB0 SamOfflineCloseHandle
          3    2 0000F340 SamOfflineConnect
          4    3 0000F530 SamOfflineConnectExternal
          5    4 0000F450 SamOfflineConnectForInstaller
          6    5 0000FC40 SamOfflineCreateAliasInDomain
          7    6 000107F0 SamOfflineCreateUserInDomain
          8    7 00010000 SamOfflineDeleteAlias
          9    8 00010B10 SamOfflineDeleteUser
         10    9 00010440 SamOfflineEnumerateAliasesInDomain
         11    A 0000F690 SamOfflineEnumerateDomainsInSamServer
         12    B 00010580 SamOfflineEnumerateUsersInDomain2
         13    C 00010E20 SamOfflineFreeMemory
         14    D 00010340 SamOfflineGetMembersInAlias
         15    E 0000F7C0 SamOfflineLookupDomainInSamServer
         16    F 0000F9F0 SamOfflineLookupNamesInDomain
         17   10 0000FB20 SamOfflineOpenAlias
         18   11 0000F8C0 SamOfflineOpenDomain
         19   12 000106D0 SamOfflineOpenUser
         20   13 0000FD90 SamOfflineQueryInformationAlias
         21   14 00010930 SamOfflineQueryInformationUser
         22   15 00010260 SamOfflineRemoveMemberFromAlias
         23   16 00010C00 SamOfflineRidToSid
         24   17 0000FEF0 SamOfflineSetInformationAlias
         25   18 00010A20 SamOfflineSetInformationUser

  Section contains the following imports:

    msvcrt.dll
             18001E818 Import Address Table
             180022940 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          55 _XcptFilter
                         38A _wcsicmp
                         44C free
                         486 malloc
                         17D _initterm
                         29E _purecall
                          57 __C_specific_handler
                         494 memmove
                         492 memcpy
                         491 memcmp
                          AE _amsg_exit
                         369 _vsnwprintf
                         496 memset

    ntdll.dll
             18001E888 Import Address Table
             1800229B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         19C NtOpenKey
                         451 RtlInitUnicodeString
                          FB NtClose
                         322 RtlCopySid
                         116 NtCreateKey
                         43F RtlImageNtHeader
                         5D9 RtlUpcaseUnicodeChar
                         52A RtlReAllocateHeap
                         2CB RtlAllocateHeap
                         3D7 RtlFormatCurrentUserKeyPath
                         525 RtlRaiseStatus
                          23 DbgPrintEx
                         5F2 RtlVirtualUnwind
                         4CA RtlLookupFunctionEntry
                         2EA RtlCaptureContext
                         3C9 RtlFindMessage
                         2D6 RtlAppendUnicodeToString
                         471 RtlIntegerToUnicodeString
                         5DD RtlUpcaseUnicodeStringToOemString
                         4B1 RtlLengthRequiredSid
                         325 RtlCopyUnicodeString
                         43A RtlIdentifierAuthoritySid
                         2D5 RtlAppendUnicodeStringToString
                          CC NtAdjustPrivilegesToken
                         1F6 NtQueryValueKey
                         25C NtSetValueKey
                         408 RtlGetGroupSecurityDescriptor
                         142 NtDeleteValueKey
                         250 NtSetSecurityObject
                         41A RtlGetOwnerSecurityDescriptor
                         420 RtlGetSaclSecurityDescriptor
                         634 RtlpNtEnumerateSubKey
                         13F NtDeleteKey
                         1DF NtQueryKey
                         1AF NtOpenThreadToken
                         1D8 NtQueryInformationToken
                         243 NtSetInformationThread
                         1F1 NtQuerySystemInformation
                         14A NtDuplicateToken
                         1A6 NtOpenProcessToken
                         306 RtlCompareUnicodeString
                         3F9 RtlGetDaclSecurityDescriptor
                         33B RtlCreateSecurityDescriptor
                         56D RtlSetGroupSecurityDescriptor
                         328 RtlCreateAcl
                         2B5 RtlAddAuditAccessAce
                         29F RtlAbsoluteToSelfRelativeSD
                         2AA RtlAddAccessAllowedAce
                         2C8 RtlAllocateAndInitializeSid
                         3E7 RtlGetAce
                         567 RtlSetDaclSecurityDescriptor
                         4CD RtlMapGenericMask
                         467 RtlInitializeSid
                         575 RtlSetOwnerSecurityDescriptor
                         57D RtlSetSaclSecurityDescriptor
                         4B3 RtlLengthSid
                         5A0 RtlSubAuthorityCountSid
                         3E3 RtlFreeUnicodeString
                         315 RtlConvertSidToUnicodeString
                         5A1 RtlSubAuthoritySid
                         5EC RtlValidSid
                         1F3 NtQuerySystemTime
                         3A8 RtlEqualSid
                         3DD RtlFreeHeap
                         276 NtUnloadKey2
                         15B NtFlushKey
                         388 RtlDosPathNameToRelativeNtPathName_U_WithStatus
                         17E NtLoadKey
                         463 RtlInitializeRXact

    RPCRT4.dll
             18001E578 Import Address Table
             1800226A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         224 UuidToStringW
                         212 RpcStringFreeW
                         21B UuidCreate

    bcrypt.dll
             18001E7B0 Import Address Table
             1800228D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1B BCryptFinishHash
                           D BCryptDestroyHash
                           8 BCryptDecrypt
                          23 BCryptHashData
                           6 BCryptCreateHash
                          27 BCryptOpenAlgorithmProvider
                          35 BCryptSetProperty
                           2 BCryptCloseAlgorithmProvider
                          1F BCryptGenerateSymmetricKey
                          21 BCryptGetProperty
                           E BCryptDestroyKey
                          12 BCryptEncrypt

    offlinelsa.dll
             18001EAB8 Import Address Table
             180022BE0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B LsaOfflineOpenPolicy
                           D LsaOfflineOpenPolicyForInstaller
                           2 LsaOfflineClose
                           E LsaOfflineQueryInformationPolicy
                           8 LsaOfflineFreeMemory
                          12 LsaOfflineSyskeyRequest
                           C LsaOfflineOpenPolicyExternal

    CRYPTBASE.dll
             18001E558 Import Address Table
             180022680 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 SystemFunction036
                           0 SystemFunction001
                           2 SystemFunction003

    api-ms-win-core-heap-obsolete-l1-1-0.dll
             18001E5D8 Import Address Table
             180022700 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 LocalAlloc
                           A LocalFree

    api-ms-win-eventing-classicprovider-l1-1-0.dll
             18001E6F8 Import Address Table
             180022820 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 GetTraceLoggerHandle
                           3 RegisterTraceGuidsW
                           0 GetTraceEnableFlags
                           7 UnregisterTraceGuids
                           5 TraceMessage
                           1 GetTraceEnableLevel

    api-ms-win-security-base-l1-1-0.dll
             18001E730 Import Address Table
             180022858 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          46 IsValidSid
                          2D GetLengthSid
                          3A GetTokenInformation
                          23 DuplicateTokenEx

    api-ms-win-core-file-l1-1-0.dll
             18001E5B8 Import Address Table
             1800226E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          22 GetFileAttributesW

    api-ms-win-core-string-l1-1-0.dll
             18001E698 Import Address Table
             1800227C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CompareStringEx

    api-ms-win-core-synch-l1-1-0.dll
             18001E6A8 Import Address Table
             1800227D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 AcquireSRWLockExclusive
                          12 InitializeSRWLock
                          1A ReleaseSRWLockExclusive

    api-ms-win-core-processthreads-l1-1-0.dll
             18001E640 Import Address Table
             180022768 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D GetCurrentThreadId
                          26 SetThreadStackGuarantee
                           A GetCurrentProcess
                          2A TerminateProcess
                          1A OpenProcessToken
                           B GetCurrentProcessId

    api-ms-win-core-processthreads-l1-1-1.dll
             18001E678 Import Address Table
             1800227A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A OpenProcess

    api-ms-win-core-errorhandling-l1-1-0.dll
             18001E598 Import Address Table
             1800226C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 UnhandledExceptionFilter
                           1 GetLastError
                           5 SetUnhandledExceptionFilter

    api-ms-win-core-handle-l1-1-0.dll
             18001E5C8 Import Address Table
             1800226F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-kernel32-legacy-l1-1-0.dll
             18001E5F0 Import Address Table
             180022718 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          34 WTSGetActiveConsoleSessionId

    api-ms-win-security-sddl-l1-1-0.dll
             18001E7A0 Import Address Table
             1800228C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConvertStringSidToSidW

    api-ms-win-security-lsalookup-l2-1-0.dll
             18001E790 Import Address Table
             1800228B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 LookupPrivilegeValueW

    api-ms-win-core-libraryloader-l1-1-0.dll
             18001E600 Import Address Table
             180022728 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 DisableThreadLibraryCalls
                           4 FreeLibrary
                           F LoadLibraryExW

    api-ms-win-core-synch-l1-2-0.dll
             18001E6C8 Import Address Table
             1800227F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 Sleep

    api-ms-win-core-profile-l1-1-0.dll
             18001E688 Import Address Table
             1800227B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    api-ms-win-core-sysinfo-l1-1-0.dll
             18001E6D8 Import Address Table
             180022800 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 GetSystemInfo
                           A GetSystemTimeAsFileTime
                           D GetTickCount

    api-ms-win-core-memory-l1-1-0.dll
             18001E620 Import Address Table
             180022748 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 VirtualAlloc
                           B VirtualProtect
                           D VirtualQuery

    api-ms-win-security-cryptoapi-l1-1-0.dll
             18001E758 Import Address Table
             180022880 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CryptAcquireContextA
                           3 CryptCreateHash
                          14 CryptGetHashParam
                           6 CryptDestroyHash
                          18 CryptHashData
                          1B CryptReleaseContext

  Summary

        1000 .data
        2000 .pdata
        6000 .rdata
        1000 .reloc
       17000 .rsrc
       1D000 .text
