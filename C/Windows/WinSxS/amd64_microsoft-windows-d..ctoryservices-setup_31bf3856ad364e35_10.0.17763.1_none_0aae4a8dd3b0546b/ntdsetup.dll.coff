Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-d..ctoryservices-setup_31bf3856ad364e35_10.0.17763.1_none_0aae4a8dd3b0546b\ntdsetup.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdsbsrv.dll
    WLDAP32.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    DSPARSE.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    RPCRT4.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-service-management-l2-1-0.dll
    CRYPT32.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-eventing-classicprovider-l1-1-0.dll
    WS2_32.dll
    logoncli.dll
    DNSAPI.dll
    api-ms-win-core-file-l2-1-2.dll
    netutils.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    bcrypt.dll
    api-ms-win-core-heap-l1-1-0.dll
    certcli.dll
    LSASRV.dll
    ADVAPI32.dll
    cryptdll.dll
    KERNEL32.dll
    ntdll.dll
    NTDSA.dll
    NTDSAPI.dll
    SAMSRV.dll
    SHLWAPI.dll

  Section contains the following exports for NTDSETUP.dll

    00000000 characteristics
    196CAED7 time date stamp
        0.00 version
           1 ordinal base
          24 number of functions
          24 number of names

    ordinal hint RVA      name

          1    0 000169D0 AdamFetchDemotionInfo
          2    1 0000DE90 AdamGetCrossRefs
          3    2 00016DE0 FreeDemotionInfo
          4    3 0000F080 NtdsAdamValidateInst
          5    4 0000F510 NtdsAdamValidateServiceAccount
          6    5 0000F550 NtdsAdamVerifyBind
          7    6 000176C0 NtdsCheckMachineAccountFlags
          8    7 000176E0 NtdsDemote
          9    8 00011160 NtdsFreeDnsRRInfo
         10    9 00017880 NtdsGetDefaultDnsName
         11    A 00004310 NtdsInstall
         12    B 00017890 NtdsInstallCancel
         13    C 00017900 NtdsInstallReplicateFull
         14    D 00008210 NtdsInstallShutdown
         15    E 00017AD0 NtdsInstallUndo
         16    F 00017B00 NtdsPrepareForDemotion
         17   10 00017C20 NtdsPrepareForDemotionUndo
         18   11 00017C40 NtdsPrepareForDsUpgrade
         19   12 00017E70 NtdsSetReplicaMachineAccount
         20   13 00002350 NtdspConfigRegistry
         21   14 00019660 NtdspDNStoRFC1779Name
         22   15 00019D70 NtdspFindSite
         23   16 00001140 NtdspValidateInstallParameters
         24   17 00007BF0 NtdspVerifyDsEnvironment

  Section contains the following imports:

    msvcrt.dll
             180025A90 Import Address Table
             18002C5B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4D9 strtoul
                         47B isxdigit
                         422 bsearch
                         471 iswcntrl
                         17C _i64tow_s
                         50B wcsncmp
                         33B _ultow_s
                         520 wprintf
                         1E1 _local_unwind
                          57 __C_specific_handler
                         363 _vsnprintf
                         466 isdigit
                         491 memcmp
                         492 memcpy
                         494 memmove
                         496 memset
                         17D _initterm
                          AE _amsg_exit
                          55 _XcptFilter
                         470 iswascii
                         516 wcstok
                         4E9 tolower
                         409 _wtol
                         1F2 _ltow
                         405 _wtoi
                         28C _msize
                         385 _wcsdup
                         4D2 strrchr
                         4A4 qsort
                         394 _wcsnicmp
                         514 wcsstr
                         1D9 _itow
                         501 wcschr
                         51B wcstoul
                         505 wcscpy_s
                         1DA _itow_s
                         518 wcstol
                         486 malloc
                         420 atoi
                         44C free
                         38A _wcsicmp
                         369 _vsnwprintf
                         4DC swprintf_s
                         502 wcscmp

    ntdsbsrv.dll
             180025D08 Import Address Table
             18002C828 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 NtdsbsrvDllInit
                           4 UnInstallBackupServices

    WLDAP32.dll
             1800254A8 Import Address Table
             18002BFC8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   155
                             Ordinal    14
                             Ordinal    12
                             Ordinal   161
                             Ordinal   142
                             Ordinal    13
                             Ordinal   170
                             Ordinal    46
                             Ordinal    73
                             Ordinal    36
                             Ordinal   127
                             Ordinal    97
                             Ordinal    41
                             Ordinal    88
                             Ordinal   135
                             Ordinal   140
                             Ordinal   147
                             Ordinal    16
                             Ordinal    27
                             Ordinal    26
                             Ordinal    18
                             Ordinal   203
                             Ordinal   206
                             Ordinal   145
                             Ordinal    79
                             Ordinal   133
                             Ordinal   113
                             Ordinal   301
                             Ordinal    69
                             Ordinal   224
                             Ordinal    21
                             Ordinal   208
                             Ordinal   157
                             Ordinal   167

    api-ms-win-core-heap-l2-1-0.dll
             180025678 Import Address Table
             18002C198 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 LocalFree
                           5 LocalReAlloc
                           2 LocalAlloc

    api-ms-win-core-errorhandling-l1-1-0.dll
             1800255D0 Import Address Table
             18002C0F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 UnhandledExceptionFilter
                           F SetUnhandledExceptionFilter
                           5 GetLastError

    api-ms-win-security-base-l1-1-0.dll
             1800258B8 Import Address Table
             18002C3D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D AddAce
                          3B GetSecurityDescriptorOwner
                          2E FreeSid
                          66 SetSecurityDescriptorSacl
                          37 GetSecurityDescriptorControl
                          42 GetTokenInformation
                           8 AddAccessAllowedAceEx
                          48 InitializeSecurityDescriptor
                          50 MakeSelfRelativeSD
                          61 SetSecurityDescriptorControl
                          4F MakeAbsoluteSD
                          39 GetSecurityDescriptorGroup
                          3A GetSecurityDescriptorLength
                          4D IsValidSid
                          45 ImpersonateLoggedOnUser
                          2C EqualSid
                          47 InitializeAcl
                          28 DuplicateToken
                          2F GetAce
                          63 SetSecurityDescriptorGroup
                          2D FindFirstFreeAce
                          64 SetSecurityDescriptorOwner
                          16 AllocateAndInitializeSid
                          62 SetSecurityDescriptorDacl
                          59 RevertToSelf
                          38 GetSecurityDescriptorDacl
                          3D GetSecurityDescriptorSacl
                          30 GetAclInformation
                          35 GetLengthSid

    api-ms-win-core-registry-l1-1-0.dll
             180025750 Import Address Table
             18002C270 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B RegDeleteValueW
                           0 RegCloseKey
                          1B RegNotifyChangeKeyValue
                          1E RegOpenKeyExW
                           9 RegDeleteTreeW
                          24 RegQueryValueExA
                          25 RegQueryValueExW
                          2E RegSetValueExW
                           2 RegCreateKeyExA
                          1D RegOpenKeyExA
                          2D RegSetValueExA

    DSPARSE.dll
             180025228 Import Address Table
             18002BD48 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F DsMakeSpnW

    api-ms-win-core-processthreads-l1-1-0.dll
             180025700 Import Address Table
             18002C220 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          4D TerminateProcess
                          10 GetCurrentThread
                           C GetCurrentProcess
                          11 GetCurrentThreadId
                           D GetCurrentProcessId
                           8 ExitProcess
                          33 OpenThreadToken

    api-ms-win-service-management-l1-1-0.dll
             1800259B8 Import Address Table
             18002C4D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 OpenSCManagerW
                           0 CloseServiceHandle
                           2 CreateServiceW
                           5 OpenServiceW
                           3 DeleteService

    api-ms-win-core-libraryloader-l1-2-0.dll
             180025698 Import Address Table
             18002C1B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 GetModuleHandleA
                          17 LoadLibraryExA
                          18 LoadLibraryExW
                           C FreeLibrary
                           1 DisableThreadLibraryCalls
                          15 GetProcAddress

    api-ms-win-core-localization-l1-2-0.dll
             1800256D0 Import Address Table
             18002C1F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          24 GetUserDefaultLangID
                           9 FormatMessageW

    api-ms-win-security-sddl-l1-1-0.dll
             1800259A8 Import Address Table
             18002C4C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ConvertSidToStringSidW

    RPCRT4.dll
             180025430 Import Address Table
             18002BF50 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         212 RpcStringFreeW
                         21B UuidCreate
                         224 UuidToStringW

    api-ms-win-core-processenvironment-l1-1-0.dll
             1800256E8 Import Address Table
             18002C208 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B GetEnvironmentVariableW
                           0 ExpandEnvironmentStringsA

    api-ms-win-core-file-l1-1-0.dll
             1800255F0 Import Address Table
             18002C110 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 DeleteFileW
                           C FindClose
                          4D RemoveDirectoryW
                          1A FindNextFileW
                          2C GetFileAttributesW
                          52 SetFileAttributesW
                           3 CreateDirectoryW
                          14 FindFirstFileW

    api-ms-win-core-string-l1-1-0.dll
             1800257D0 Import Address Table
             18002C2F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CompareStringW
                           0 CompareStringEx
                           6 MultiByteToWideChar

    api-ms-win-core-handle-l1-1-0.dll
             180025648 Import Address Table
             18002C168 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-service-management-l2-1-0.dll
             1800259E8 Import Address Table
             18002C508 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 ChangeServiceConfig2W

    CRYPT32.dll
             1800251F0 Import Address Table
             18002BD10 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          E1 CryptUnprotectData
                          E2 CryptUnprotectMemory
                          C4 CryptProtectMemory
                          C3 CryptProtectData

    api-ms-win-core-sysinfo-l1-1-0.dll
             180025858 Import Address Table
             18002C378 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          19 GetTickCount
                          15 GetSystemTimeAsFileTime
                           3 GetComputerNameExW
                           F GetSystemDirectoryW
                          1F GetWindowsDirectoryW

    api-ms-win-service-winsvc-l1-1-0.dll
             1800259F8 Import Address Table
             18002C518 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A QueryServiceStatus
                           2 ControlService

    api-ms-win-core-synch-l1-2-0.dll
             180025848 Import Address Table
             18002C368 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D Sleep

    api-ms-win-eventing-classicprovider-l1-1-0.dll
             180025888 Import Address Table
             18002C3A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 GetTraceEnableFlags
                           2 GetTraceLoggerHandle
                           1 GetTraceEnableLevel
                           3 RegisterTraceGuidsW
                           6 TraceMessageVa

    WS2_32.dll
             1800255C0 Import Address Table
             18002C0E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    14

    logoncli.dll
             180025A80 Import Address Table
             18002C5A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 DsGetDcNameW

    DNSAPI.dll
             180025218 Import Address Table
             18002BD38 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          AA DnsValidateName_W

    api-ms-win-core-file-l2-1-2.dll
             180025638 Import Address Table
             18002C158 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CopyFileW

    netutils.dll
             180025BF8 Import Address Table
             18002C718 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 NetApiBufferFree

    api-ms-win-core-synch-l1-1-0.dll
             1800257F0 Import Address Table
             18002C310 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1B InitializeSRWLock
                          1D LeaveCriticalSection
                           3 CreateEventA
                           1 AcquireSRWLockShared
                          11 EnterCriticalSection
                           0 AcquireSRWLockExclusive
                          24 ReleaseSRWLockExclusive
                          18 InitializeCriticalSection
                           F DeleteCriticalSection
                          25 ReleaseSRWLockShared

    api-ms-win-core-rtlsupport-l1-1-0.dll
             1800257B0 Import Address Table
             18002C2D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F RtlVirtualUnwind
                           9 RtlLookupFunctionEntry
                           2 RtlCaptureContext

    api-ms-win-core-profile-l1-1-0.dll
             180025740 Import Address Table
             18002C260 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    bcrypt.dll
             180025A10 Import Address Table
             18002C530 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D BCryptDestroyHash
                           2 BCryptCloseAlgorithmProvider
                          1B BCryptFinishHash
                          1D BCryptGenRandom
                           6 BCryptCreateHash
                          23 BCryptHashData
                          27 BCryptOpenAlgorithmProvider
                          21 BCryptGetProperty

    api-ms-win-core-heap-l1-1-0.dll
             180025658 Import Address Table
             18002C178 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 GetProcessHeap
                           2 HeapAlloc
                           6 HeapFree

    certcli.dll
             180025A58 Import Address Table
             18002C578 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          14 CACreateLocalAutoEnrollmentObject
                          1B CADeleteLocalAutoEnrollmentObject

    LSASRV.dll
             180025258 Import Address Table
             18002BD78 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          35 LsaIFree_LSAPR_POLICY_INFORMATION
                          70 LsaIQueryInformationPolicyTrusted
                         109 LsarSetInformationPolicy
                          7C LsaISafeMode
                          FD LsarClose
                          6D LsaIOpenPolicyTrusted

    ADVAPI32.dll
             180025130 Import Address Table
             18002BC50 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         1D2 LsaLookupSids
                         2C0 ReportEventW
                         2AE RegisterEventSourceW
                          ED DeregisterEventSource
                         1D5 LsaNtStatusToWinError
                         1CD LsaLookupNames
                         267 RegCreateKeyW
                         1C3 LsaFreeMemory
                          7D ConvertStringSDToSDDomainW
                         214 OpenEventLogW
                         1E0 LsaQueryInformationPolicy
                         1D7 LsaOpenPolicy
                         1B5 LsaClose
                         1EB LsaSetInformationPolicy
                         262 RegCreateKeyA
                          61 ClearEventLogW
                         26F RegDeleteKeyW
                         2D8 SetEntriesInAclW
                          64 CloseEventLog
                         2E3 SetNamedSecurityInfoW
                         157 GetNamedSecurityInfoW
                         1A5 LogonUserW
                         28F RegOpenKeyW

    cryptdll.dll
             180025A70 Import Address Table
             18002C590 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 CDGenerateRandomBits

    KERNEL32.dll
             180025238 Import Address Table
             18002BD58 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         3EE MoveFileW
                         2B2 GetPrivateProfileStringW
                         1E5 GetComputerNameW

    ntdll.dll
             180025C08 Import Address Table
             18002C728 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         315 RtlConvertSidToUnicodeString
                         43A RtlIdentifierAuthoritySid
                         4AE RtlLargeIntegerToChar
                         3A8 RtlEqualSid
                         1AF NtOpenThreadToken
                          FB NtClose
                         52A RtlReAllocateHeap
                         417 RtlGetNtProductType
                         243 NtSetInformationThread
                         19C NtOpenKey
                         14E NtEnumerateKey
                         13F NtDeleteKey
                         4B2 RtlLengthSecurityDescriptor
                         1DF NtQueryKey
                          3D EtwEventUnregister
                         696 WinSqmAddToStream
                         322 RtlCopySid
                         4B1 RtlLengthRequiredSid
                         5A0 RtlSubAuthorityCountSid
                         5A1 RtlSubAuthoritySid
                         467 RtlInitializeSid
                         5EC RtlValidSid
                         4DD RtlNtStatusToDosError
                         3DD RtlFreeHeap
                         2C8 RtlAllocateAndInitializeSid
                         451 RtlInitUnicodeString
                         2CB RtlAllocateHeap
                         4B3 RtlLengthSid
                          5B EvtIntReportEventAndSourceAsync
                          3B EtwEventRegister
                         6A7 WinSqmIsOptedIn

    NTDSA.dll
             180025290 Import Address Table
             18002BDB0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          85 THFree
                          7F SampSetDsa
                          6E NameMatched
                          59 GetConfigurationName
                          43 DsIsDCReadOnly
                          5A GetConfigurationNamesList
                          4F DsaDisableUpdates
                          83 THCreate
                          17 DirErrorToWinError
                           0 AppendRDN
                          4A DsUninitialize
                          25 DirReplicaDemote
                           B DSInstanceFromSetupEx
                          26 DirReplicaGetDemoteTarget
                          2C DirSearch
                          74 QuoteRDNValue
                          8D TrimDSNameBy
                          8E UnImpersonateAnyClient
                          82 THClearErrors
                          50 DsaEnableUpdates
                          5F InitCommarg
                          21 DirRead
                          87 THQuery
                          84 THDestroy
                          4C DsUnloadDLL
                          81 THAlloc
                          5C GetRDNInfoExternal
                          45 DsLoadDLL
                          23 DirReplicaAdd
                          2B DirReplicaSynchronize
                           A DSInstanceFromNameEx
                          51 DsaSetInstallCallback
                          6F NameMatchedStringNameOnly
                          1B DirModifyEntry
                          13 DirAddEntry
                          2A DirReplicaSetCredentials
                           3 CountNameParts
                          86 THGetErrorString
                          40 DsInitialize
                          5E ImpersonateAnyClient

    NTDSAPI.dll
             1800253D8 Import Address Table
             18002BEF8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6C DsReplicaSyncW
                           D DsBindWithSpnExW
                          5B DsRemoveDsDomainW
                          39 DsInitDemotionW
                           A DsBindWithCredW
                          74 DsUnBindW
                           5 DsBindByInstanceW
                          63 DsReplicaDemotionW
                          5D DsRemoveDsServerW
                          1E DsFinishDemotionW

    SAMSRV.dll
             180025450 Import Address Table
             18002BF70 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          14 SamIDemoteUndo
                          45 SamIPromoteUndo
                          4F SamIReplaceDownlevelDatabase
                         120 SampUsingDsData
                          44 SamIPromote
                          13 SamIDemote
                          5F SamIUnLoadDownlevelDatabase
                          39 SamILoadDownlevelDatabase

    SHLWAPI.dll
             180025498 Import Address Table
             18002BFB8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6B PathIsRootW

  Summary

        2000 .data
        2000 .pdata
        A000 .rdata
        1000 .reloc
        1000 .rsrc
       24000 .text
