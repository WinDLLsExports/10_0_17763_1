Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-kdscli-dll_31bf3856ad364e35_10.0.17763.1_none_2f9ff5d3894dbe31\KdsCli.dll

File Type: DLL

  Image has the following dependencies:

    WLDAP32.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    bcrypt.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    CRYPT32.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-core-timezone-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    profapi.dll
    api-ms-win-security-lsalookup-l1-1-2.dll
    api-ms-win-security-lsapolicy-l1-1-0.dll
    api-ms-win-security-base-private-l1-1-0.dll
    api-ms-win-core-kernel32-legacy-l1-1-0.dll
    NTASN1.dll
    ntdll.dll
    api-ms-win-core-delayload-l1-1-1.dll
    api-ms-win-core-delayload-l1-1-0.dll

  Image has the following delay load dependencies:

    RPCRT4.dll
    logoncli.dll
    netutils.dll

  Section contains the following exports for KdsCli.dll

    00000000 characteristics
    2B3EB02E time date stamp
        0.00 version
           1 ordinal base
          48 number of functions
          48 number of names

    ordinal hint RVA      name

          1    0 00002FB0 CreateRootKey
          2    1 00007A00 DeleteAllCachedKeys
          3    2 000070E0 FindAndReadSIDKeyInCache
          4    3 00007500 FindKeyForOfflineUsage
          5    4 00002DF0 FreeRootKey
          6    5 00002D70 FreeRootKeyConfig
          7    6 00004940 FreeRootKeyMetaDataList
          8    7 00004CE0 FreeServerConfig
          9    8 00007F10 GenerateDerivedKey
         10    9 000087A0 GenerateEphemeralKeyPair
         11    A 00007E30 GenerateKDFContext
         12    B 00008AA0 GenerateSIDPublicKeyBlob
         13    C 00008440 GenerateSecretAgreementPrivateKey
         14    D 00004790 GetAllRootKeys
         15    E 00004A80 GetAllRootKeysMetaData
         16    F 00009C30 GetAndLockCachedRPCBinding
         17   10 0000A990 GetCachedMachineDomainInfo
         18   11 0000A3D0 GetCurrentIntervalID
         19   12 0000A380 GetCurrentL0ID
         20   13 0000A330 GetCurrentTimeInULL
         21   14 00001660 GetDCInfo
         22   15 00005720 GetDefaultServerConfig
         23   16 0000AB70 GetFullDCName
         24   17 0000A440 GetIntervalStartTime
         25   18 00002110 GetKDSSrvConfigPath
         26   19 0000AC60 GetKdsKeyCycleDuration
         27   1A 0000AD60 GetKey
         28   1B 00001210 GetLdapBinding
         29   1C 000021F0 GetMRKPath
         30   1D 00004700 GetRootKey
         31   1E 00006060 GetSIDKeyCacheFolder
         32   1F 000063C0 GetSIDKeyFileName
         33   20 000057D0 GetServerConfig
         34   21 0000A210 GetUserSidStr
         35   22 000091E0 KdsCreateClientBinding
         36   23 0000B200 KdsGetEpochLength
         37   24 0000B9B0 KdsGetGmsaPasswordBasedOnKeyId
         38   25 0000B9A0 KdsGetGmsaPasswordBasedOnTimestamp
         39   26 0000B180 KdsGetKeyStartTime
         40   27 0000BE30 SIDKeyProtect
         41   28 00009D70 SIDKeyProvAlloc
         42   29 00009DA0 SIDKeyProvFree
         43   2A 0000C380 SIDKeyUnprotect
         44   2B 00005BF0 SetServerConfig
         45   2C 00008250 TestServerConfig
         46   2D 00009D30 UnlockRpcCache
         47   2E 000058C0 ValidateSrvConfig
         48   2F 00006700 WriteSIDKeyInCache

  Section contains the following imports:

    WLDAP32.dll
             18000F488 Import Address Table
             1800123E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    41
                             Ordinal    69
                             Ordinal   145
                             Ordinal    97
                             Ordinal   140
                             Ordinal    14
                             Ordinal   203
                             Ordinal    16
                             Ordinal   127
                             Ordinal    27
                             Ordinal    36
                             Ordinal    79
                             Ordinal    13
                             Ordinal   147
                             Ordinal   167
                             Ordinal   142
                             Ordinal    26
                             Ordinal   157
                             Ordinal   224
                             Ordinal    73
                             Ordinal   301

    api-ms-win-core-libraryloader-l1-2-0.dll
             18000F620 Import Address Table
             180012578 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 DisableThreadLibraryCalls

    api-ms-win-security-sddl-l1-1-0.dll
             18000F7C0 Import Address Table
             180012718 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConvertStringSidToSidW
                           1 ConvertSidToStringSidW
                           2 ConvertStringSecurityDescriptorToSecurityDescriptorW

    api-ms-win-core-errorhandling-l1-1-0.dll
             18000F558 Import Address Table
             1800124B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F SetUnhandledExceptionFilter
                          11 UnhandledExceptionFilter
                           5 GetLastError

    bcrypt.dll
             18000F7E0 Import Address Table
             180012738 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          21 BCryptGetProperty
                           2 BCryptCloseAlgorithmProvider
                          27 BCryptOpenAlgorithmProvider
                          24 BCryptImportKey
                          32 BCryptSecretAgreement
                          1B BCryptFinishHash
                          35 BCryptSetProperty
                          25 BCryptImportKeyPair
                           F BCryptDestroySecret
                           A BCryptDeriveKey
                          19 BCryptExportKey
                          1E BCryptGenerateKeyPair
                           D BCryptDestroyHash
                          23 BCryptHashData
                           6 BCryptCreateHash
                           E BCryptDestroyKey
                          26 BCryptKeyDerivation
                          1F BCryptGenerateSymmetricKey
                          1A BCryptFinalizeKeyPair
                          1D BCryptGenRandom

    api-ms-win-core-heap-l2-1-0.dll
             18000F600 Import Address Table
             180012558 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 LocalFree

    api-ms-win-core-profile-l1-1-0.dll
             18000F670 Import Address Table
             1800125C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    api-ms-win-core-processthreads-l1-1-0.dll
             18000F630 Import Address Table
             180012588 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 GetCurrentThread
                          31 OpenProcessToken
                          33 OpenThreadToken
                           C GetCurrentProcess
                          4D TerminateProcess
                          11 GetCurrentThreadId
                           D GetCurrentProcessId

    api-ms-win-core-sysinfo-l1-1-0.dll
             18000F6E0 Import Address Table
             180012638 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 GetSystemTime
                          19 GetTickCount
                          15 GetSystemTimeAsFileTime

    api-ms-win-core-rtlsupport-l1-1-0.dll
             18000F680 Import Address Table
             1800125D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 RtlCaptureContext
                           9 RtlLookupFunctionEntry
                           F RtlVirtualUnwind

    api-ms-win-core-file-l1-1-0.dll
             18000F578 Import Address Table
             1800124D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          49 ReadFile
                          2E GetFileSize
                           3 CreateDirectoryW
                          1A FindNextFileW
                          5B WriteFile
                          4D RemoveDirectoryW
                           C FindClose
                           6 CreateFileW
                           9 DeleteFileW
                          12 FindFirstFileExW

    CRYPT32.dll
             18000F448 Import Address Table
             1800123A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          C3 CryptProtectData
                          E1 CryptUnprotectData
                          7D CryptBinaryToStringW

    api-ms-win-core-handle-l1-1-0.dll
             18000F5D0 Import Address Table
             180012528 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-synch-l1-1-0.dll
             18000F6B0 Import Address Table
             180012608 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 AcquireSRWLockExclusive
                          24 ReleaseSRWLockExclusive
                          25 ReleaseSRWLockShared
                           1 AcquireSRWLockShared
                          1B InitializeSRWLock

    api-ms-win-security-base-l1-1-0.dll
             18000F710 Import Address Table
             180012668 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          63 SetSecurityDescriptorGroup
                          64 SetSecurityDescriptorOwner
                          62 SetSecurityDescriptorDacl
                          48 InitializeSecurityDescriptor
                          4C IsValidSecurityDescriptor
                          3A GetSecurityDescriptorLength
                          47 InitializeAcl
                          1E CopySid
                          4D IsValidSid
                          35 GetLengthSid
                          42 GetTokenInformation
                           7 AddAccessAllowedAce

    api-ms-win-core-heap-l1-1-0.dll
             18000F5E0 Import Address Table
             180012538 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 HeapFree
                           0 GetProcessHeap
                           2 HeapAlloc

    api-ms-win-core-timezone-l1-1-0.dll
             18000F700 Import Address Table
             180012658 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A SystemTimeToFileTime

    api-ms-win-core-string-l1-1-0.dll
             18000F6A0 Import Address Table
             1800125F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CompareStringW

    profapi.dll
             18000F978 Import Address Table
             1800128D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   104

    api-ms-win-security-lsalookup-l1-1-2.dll
             18000F788 Import Address Table
             1800126E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F LsaLookupUserAccountType

    api-ms-win-security-lsapolicy-l1-1-0.dll
             18000F798 Import Address Table
             1800126F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 LsaQueryInformationPolicy
                           1 LsaClose
                           6 LsaFreeMemory
                           E LsaOpenPolicy

    api-ms-win-security-base-private-l1-1-0.dll
             18000F778 Import Address Table
             1800126D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 IsValidRelativeSecurityDescriptor

    api-ms-win-core-kernel32-legacy-l1-1-0.dll
             18000F610 Import Address Table
             180012568 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 CreateFileTransactedW

    NTASN1.dll
             18000F468 Import Address Table
             1800123C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal     4
                             Ordinal     2
                             Ordinal     5

    ntdll.dll
             18000F888 Import Address Table
             1800127E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         8B8 _ultow_s
                         92A wcscpy_s
                         8CD _wtoi64
                          45 EtwEventWriteTransfer
                         8B4 _ui64tow_s
                         131 NtCreateTransaction
                         223 NtRollbackTransaction
                         926 wcscat_s
                         927 wcschr
                         100 NtCommitTransaction
                         243 NtSetInformationThread
                         4DD RtlNtStatusToDosError
                         451 RtlInitUnicodeString
                         5C4 RtlUnicodeStringToInteger
                         882 __C_specific_handler
                         4CC RtlMakeSelfRelativeSD
                         43F RtlImageNtHeader
                          3B EtwEventRegister
                          3D EtwEventUnregister
                          46 EtwGetTraceEnableFlags
                          48 EtwGetTraceLoggerHandle
                          47 EtwGetTraceEnableLevel
                          4F EtwRegisterTraceGuidsW
                         919 swprintf_s
                          54 EtwTraceMessage
                         8F5 memcpy
                         8F9 memset
                          56 EtwUnregisterTraceGuids
                         928 wcscmp

    api-ms-win-core-delayload-l1-1-1.dll
             18000F548 Import Address Table
             1800124A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ResolveDelayLoadedAPI

    api-ms-win-core-delayload-l1-1-0.dll
             18000F538 Import Address Table
             180012490 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 DelayLoadFailureHook

  Section contains the following delay load imports:

    RPCRT4.dll
              00000001 Characteristics
      00000001800145F0 Address of HMODULE
      0000000180016000 Import Address Table
      00000001800119C8 Import Name Table
      0000000180011B48 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000EA4B   220 UuidFromStringW
                                    000000018000EC6A    A2 NdrClientCall3
                                    000000018000EAD6   212 RpcStringFreeW
                                    000000018000EAE8   224 UuidToStringW
                                    000000018000EAFA   174 RpcBindingFromStringBindingW
                                    000000018000EB0C   20E RpcStringBindingComposeW
                                    000000018000EBCD   172 RpcBindingFree
                                    000000018000EC7C    2E I_RpcExceptionFilter
                                    000000018000EBA9   183 RpcBindingSetAuthInfoExW
                                    000000018000EBBB   194 RpcEpResolveBinding

    logoncli.dll
              00000001 Characteristics
      00000001800145F8 Address of HMODULE
      0000000180016058 Import Address Table
      0000000180011A20 Import Name Table
      0000000180011B78 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000EB1E    12 DsGetDcNameW

    netutils.dll
              00000001 Characteristics
      0000000180014600 Address of HMODULE
      0000000180016068 Import Address Table
      0000000180011A30 Import Name Table
      0000000180011BA0 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000EBDF     1 NetApiBufferFree

  Summary

        1000 .data
        1000 .didat
        1000 .pdata
        5000 .rdata
        1000 .reloc
        1000 .rsrc
        E000 .text
